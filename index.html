<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Silay Explorer Prototype</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
   
<style>
/* --- 1. LOAD THE CUSTOM FONT --- */
@font-face {
    font-family: 'Barabara';
    src: url('BARABARA-final.woff') format('woff'); 
    font-weight: normal;
    font-style: normal;
}

    :root {
        --primary-green: #2F5245; /* Dark Green */
        --secondary-green: #5C8C7A;
        --light-bg: #F4F6F5;
        --text-dark: #1A1A1A;
        --white: #FFFFFF;
        --gray: #888888;
        --chat-user-bg: #2F5245;
        --chat-bot-bg: #E0E0E0;
        --red-alert: #FF4B4B;
    }

    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        font-family: 'Poppins', sans-serif;
    }

    body {
        background-color: #e0e0e0;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
    }

    /* Mobile Container */
    .app-container {
        width: 100%;
        max-width: 414px; /* Phone width */
        height: 100vh;
        max-height: 896px;
        background-color: var(--light-bg);
        position: relative;
        overflow: hidden;
        box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }

    /* Screen Management */
    .screen {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        overflow-y: auto;
        display: none; /* Hidden by default */
        background: var(--light-bg);
        padding-bottom: 20px;
    }

    .screen.active {
        display: block;
        animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    /* --- SIDE MENU DRAWER (LEFT) --- */
    .side-menu {
        position: absolute;
        top: 0;
        left: -100%; 
        width: 75%;
        height: 100%;
        background: white;
        z-index: 2000;
        transition: left 0.3s ease-in-out;
        box-shadow: 4px 0 15px rgba(0,0,0,0.1);
        display: flex;
        flex-direction: column;
    }

    .side-menu.active { left: 0; }

    /* --- NOTIFICATION DRAWER (RIGHT) --- */
    .notif-drawer {
        position: absolute;
        top: 0;
        right: -100%; /* Hidden on right */
        width: 80%;
        height: 100%;
        background: white;
        z-index: 2001;
        transition: right 0.3s ease-in-out;
        box-shadow: -4px 0 15px rgba(0,0,0,0.1);
        display: flex;
        flex-direction: column;
    }

    .notif-drawer.active { right: 0; }

    /* Shared Overlay for Menus */
    .menu-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        z-index: 1999;
        display: none;
    }
    
    .menu-overlay.active { display: block; }

    .menu-header {
        background: var(--primary-green);
        padding: 40px 20px 20px 20px;
        color: white;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .menu-list {
        list-style: none;
        padding: 20px;
    }

    .menu-list li {
        padding: 15px 0;
        border-bottom: 1px solid #f0f0f0;
        color: var(--text-dark);
        font-size: 1rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .menu-list li:active { opacity: 0.6; }

    /* Notification Items Style */
    .notif-item {
        padding: 15px;
        border-bottom: 1px solid #eee;
        display: flex;
        gap: 15px;
        align-items: flex-start;
        cursor: pointer;
        transition: background 0.2s;
    }
    
    .notif-item:active { background: #f9f9f9; }
    
    .notif-item.unread { background: #f0f7f4; }

    .notif-icon-box {
        width: 40px;
        height: 40px;
        background: #e0e0e0;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        color: var(--primary-green);
        flex-shrink: 0;
    }

    .notif-text h4 { font-size: 0.9rem; margin-bottom: 3px; color: var(--text-dark); }
    .notif-text p { font-size: 0.75rem; color: #666; line-height: 1.3; }
    .notif-time { font-size: 0.65rem; color: #999; margin-top: 5px; display: block; }

    /* --- SCREEN 1: LANDING --- */
    #landing-screen {
        background-image: url('landing screen1.jpg'); 
        background-size: cover;
        background-position: center;
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        align-items: center;
        text-align: center;
        padding: 60px 20px;
    }

    .landing-content h1 {
        font-family: 'Barabara', sans-serif;
        text-transform: uppercase;
        color: white;
        font-size: 2rem;      
        white-space: nowrap;    
        letter-spacing: 1px;    
        line-height: 1;
        margin-bottom: 10px;
        text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    .landing-content p {
        font-family: 'Montserrat', sans-serif;
        color: #f0f0f0;
        font-size: 1rem;
        margin-bottom: 40px;
    }

    .btn-primary {
        background-color: var(--primary-green);
        color: white;
        border: none;
        padding: 16px 50px;
        border-radius: 30px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        transition: transform 0.1s;
    }

    .btn-primary:active { transform: scale(0.98); }

    /* --- SCREEN 2: HOME --- */
    .home-header {
        background: linear-gradient(rgba(0,0,0,0.1), rgba(0,0,0,0.4)), url('homehead.jpg') center/cover;
        height: 250px;
        padding: 20px;
        color: white;
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        position: relative;
    }

    .top-nav {
        position: absolute;
        top: 40px;
        left: 20px;
        right: 20px;
        display: flex;
        justify-content: space-between;
        color: white;
        font-size: 1.2rem;
        z-index: 10;
    }

    /* Red Dot Badge */
    .bell-wrapper {
        position: relative;
        cursor: pointer;
    }

    .red-dot {
        position: absolute;
        top: -2px;
        right: -1px;
        width: 10px;
        height: 10px;
        background-color: var(--red-alert);
        border-radius: 50%;
        border: 2px solid white;
        display: none; 
        animation: pulse 2s infinite;
    }

    .red-dot.visible { display: block; }

    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.2); }
        100% { transform: scale(1); }
    }

    .search-bar {
        background: white;
        border-radius: 25px;
        padding: 12px 20px;
        margin-top: 15px;
        display: flex;
        align-items: center;
        color: var(--gray);
        font-size: 0.9rem;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .menu-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        padding: 20px;
    }

    .menu-btn {
        background: white;
        border: 1px solid #eee;
        border-radius: 15px;
        padding: 15px;
        display: flex;
        align-items: center;
        gap: 12px;
        cursor: pointer;
        transition: 0.2s;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }

    .menu-btn:active { background-color: #f0f0f0; }

    .menu-btn i {
        font-size: 1.4rem;
        color: var(--primary-green);
    }

    .menu-btn h4 { font-size: 0.9rem; color: var(--text-dark); margin-bottom: 2px; }
    .menu-btn p { font-size: 0.7rem; color: var(--gray); }

    .section-title {
        padding: 0 20px;
        font-size: 1.2rem;
        color: var(--primary-green);
        font-weight: 700;
        margin-top: 10px;
    }

    .card-scroll {
        display: flex;
        overflow-x: auto;
        padding: 15px 20px;
        gap: 15px;
        scrollbar-width: none;
        padding-right: 20px; 
    }
    .card-scroll::-webkit-scrollbar { display: none; }

    .card {
        width: 280px;      /* Fixed width */
        height: 180px;     /* Fixed height */
        background: var(--primary-green);
        border-radius: 15px;
        overflow: hidden;
        position: relative;
        flex-shrink: 0;    
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .card img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        opacity: 0.85;
        transition: opacity 0.2s;
    }
    
    .card:active img { opacity: 0.6; }

    .card-text {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        padding: 15px;
        background: linear-gradient(transparent, rgba(0,0,0,0.8));
        color: white;
    }

    /* --- ITINERARY SETUP SCREEN CSS --- */
    .setup-container {
        padding: 20px;
    }

    .pref-section {
        margin-bottom: 30px;
    }

    .pref-title {
        font-size: 1.1rem;
        color: var(--text-dark);
        margin-bottom: 15px;
        font-weight: 600;
    }

    .chip-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }

    .chip {
        padding: 10px 20px;
        border-radius: 25px;
        background: white;
        border: 1px solid #ddd;
        color: #555;
        font-size: 0.9rem;
        cursor: pointer;
        transition: all 0.2s;
    }

    .chip.selected {
        background: var(--primary-green);
        color: white;
        border-color: var(--primary-green);
        box-shadow: 0 4px 10px rgba(47, 82, 69, 0.3);
    }

    /* --- SCREEN 3: ITINERARY RESULT --- */
    .page-header {
        background: #e8eceb;
        padding: 50px 20px 20px;
        border-bottom-left-radius: 25px;
        border-bottom-right-radius: 25px;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    
    .header-title h2 { font-size: 1.3rem; color: var(--text-dark); }
    .header-title p { font-size: 0.85rem; color: #666; }

    .itinerary-card {
        background: #ffffff;
        margin: 15px 20px;
        padding: 20px;
        border-radius: 20px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        border-left: 5px solid var(--primary-green);
    }

    .itinerary-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 12px;
        color: var(--primary-green);
        font-weight: 700;
        font-size: 1rem;
    }

    .dynamic-list {
        list-style: none;
        padding: 0;
    }

    .dynamic-item {
        display: flex;
        align-items: flex-start;
        gap: 10px;
        padding: 10px 0;
        border-bottom: 1px solid #f4f4f4;
    }

    .dynamic-item:last-child { border-bottom: none; }

    .item-checkbox {
        width: 18px;
        height: 18px;
        margin-top: 3px;
        accent-color: var(--primary-green);
        cursor: pointer;
    }

    .item-info h4 { font-size: 0.9rem; color: #333; margin-bottom: 2px; }
    .item-info p { font-size: 0.75rem; color: #888; }
    .item-time { font-size: 0.75rem; color: var(--secondary-green); font-weight: 600; display: block; margin-bottom: 2px;}

    /* Style for unchecked/checked items */
    .dynamic-item.disabled .item-info { opacity: 0.5; text-decoration: line-through; }

    /* --- SHARED UI --- */
    .back-btn {
        position: absolute;
        top: 40px;
        left: 20px;
        background: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 100;
        box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        color: var(--text-dark);
    }

    /* --- SCREEN 4: INTERACTIVE MAP --- */
    #map-screen {
        position: relative;
        background-color: #eee;
    }

    .real-map-container {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        z-index: 0; /* Map stays in background */
    }

    .real-map-container iframe {
        width: 100%;
        height: 100%;
        border: 0;
        pointer-events: all;
    }

    .bottom-sheet {
        position: absolute;
        bottom: 25px;
        left: 15px;
        right: 15px;
        background: #2a3d35; /* Dark UI from screenshot */
        border-radius: 25px;
        padding: 25px;
        color: white;
        box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        z-index: 10; /* Ensure it's on top of the map */
    }

    .sheet-actions {
        display: flex;
        gap: 10px;
        margin-top: 20px;
    }

    .action-btn {
        background: rgba(255,255,255,0.1);
        border: none;
        color: white;
        padding: 12px 5px;
        border-radius: 12px;
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 5px;
        font-size: 0.75rem;
        cursor: pointer;
    }
    
    .action-btn.green-highlight { background: #4CAF50; color: white; }

    /* --- SCREEN 5: DETAIL --- */
    .detail-img {
        width: 100%;
        height: 380px;
        object-fit: cover;
        border-bottom-left-radius: 35px;
        border-bottom-right-radius: 35px;
    }

    .detail-content {
        padding: 25px;
        background: var(--light-bg);
    }

    .detail-tabs {
        display: flex;
        gap: 25px;
        margin: 20px 0;
        border-bottom: 1px solid #ddd;
        padding-bottom: 10px;
    }

    .tab {
        font-weight: 600;
        color: var(--gray);
        cursor: pointer;
        padding-bottom: 5px;
        font-size: 0.95rem;
    }
    .tab.active { color: var(--primary-green); border-bottom: 3px solid var(--primary-green); }

    /* --- SCREEN 6: EVENTS --- */
    .calendar-header {
        padding: 50px 20px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: white;
    }
    
    .calendar-grid {
        padding: 10px 25px;
        background: white;
        margin-bottom: 20px;
        border-bottom-left-radius: 20px;
        border-bottom-right-radius: 20px;
    }
    
    .cal-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
    }
    
    .cal-day { font-weight: bold; width: 30px; text-align: center; font-size: 0.9rem; color: var(--gray); }
    .cal-date { width: 30px; height: 30px; line-height: 30px; text-align: center; color: #333; font-size: 0.95rem; }
    .cal-date.selected { background: #111; color: white; border-radius: 50%; }

    .event-card {
        margin: 0 20px;
        background: white;
        border-radius: 18px;
        overflow: hidden;
        box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        margin-bottom: 20px;
    }

    /* --- QR SCANNER SCREEN CSS --- */
    #qr-screen {
        background-color: black;
        display: none;
    }

    #qr-video {
        width: 100%;
        height: 100%;
        object-fit: cover;
        position: absolute;
        top: 0;
        left: 0;
    }

    .scan-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        z-index: 5;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
    }

    .scan-box {
        width: 250px;
        height: 250px;
        border: 2px solid rgba(255,255,255,0.5);
        position: relative;
        border-radius: 20px;
        box-shadow: 0 0 0 1000px rgba(0,0,0,0.5); /* Darkens area outside box */
    }

    /* Corner accents */
    .scan-box::before, .scan-box::after {
        content: '';
        position: absolute;
        width: 40px;
        height: 40px;
        border-color: var(--primary-green); /* Green corners */
        border-style: solid;
        transition: all 0.2s;
    }

    .scan-box::before {
        top: -2px; left: -2px;
        border-width: 4px 0 0 4px;
        border-top-left-radius: 20px;
    }

    .scan-box::after {
        bottom: -2px; right: -2px;
        border-width: 0 4px 4px 0;
        border-bottom-right-radius: 20px;
    }

    .scan-text {
        color: white;
        margin-top: 20px;
        font-size: 0.9rem;
        z-index: 10;
        text-align: center;
    }

    /* Animation for the scanning line */
    .scan-line {
        width: 100%;
        height: 2px;
        background: var(--primary-green);
        position: absolute;
        top: 10%;
        box-shadow: 0 0 4px var(--primary-green);
        animation: scanMove 2s infinite linear;
    }

    @keyframes scanMove {
        0% { top: 10%; opacity: 0; }
        50% { opacity: 1; }
        100% { top: 90%; opacity: 0; }
    }

    /* --- NEW AI CHAT CSS --- */
    .chat-fab {
        position: absolute;
        bottom: 20px;
        right: 20px;
        width: 60px;
        height: 60px;
        background-color: var(--primary-green);
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        color: white;
        font-size: 1.5rem;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        cursor: pointer;
        z-index: 999; /* Float on top */
        transition: transform 0.2s;
    }

    .chat-fab:active { transform: scale(0.9); }

    .chat-screen-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: white;
        z-index: 1000;
        display: none;
        flex-direction: column;
    }

    .chat-header {
        background: var(--primary-green);
        padding: 20px;
        padding-top: 40px; /* Safe area for status bar */
        color: white;
        display: flex;
        align-items: center;
        gap: 15px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .chat-messages {
        flex: 1;
        padding: 20px;
        overflow-y: auto;
        background: #f4f6f5;
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    .message {
        max-width: 80%;
        padding: 12px 16px;
        border-radius: 18px;
        font-size: 0.95rem;
        line-height: 1.4;
    }

    .message.user {
        background-color: var(--primary-green);
        color: white;
        align-self: flex-end;
        border-bottom-right-radius: 4px;
    }

    .message.bot {
        background-color: #e0e0e0;
        color: #333;
        align-self: flex-start;
        border-bottom-left-radius: 4px;
    }

    .typing-indicator {
        font-size: 0.8rem;
        color: #888;
        margin-left: 10px;
        font-style: italic;
        display: none;
    }

    .chat-input-area {
        padding: 15px;
        background: white;
        border-top: 1px solid #eee;
        display: flex;
        gap: 10px;
        align-items: center;
    }

    .chat-input {
        flex: 1;
        padding: 12px;
        border: 1px solid #ddd;
        border-radius: 25px;
        outline: none;
        font-size: 1rem;
    }

    .send-btn {
        background: var(--primary-green);
        color: white;
        width: 45px;
        height: 45px;
        border-radius: 50%;
        border: none;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
    }

    /* --- ABOUT PAGE CSS --- */
    .about-logo {
        width: 100px;
        height: 100px;
        background: var(--primary-green);
        border-radius: 25px;
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 40px auto 20px;
        color: white;
        font-size: 3rem;
        box-shadow: 0 10px 20px rgba(47, 82, 69, 0.2);
    }

    .about-content {
        padding: 30px;
        text-align: center;
    }

    .version-tag {
        background: #e0e0e0;
        color: #555;
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 0.8rem;
        display: inline-block;
        margin-bottom: 20px;
    }

    .developer-section {
        margin-top: 40px;
        border-top: 1px solid #eee;
        padding-top: 30px;
    }
</style>
</head>
<body>

    <div class="app-container">
    
        <div id="menu-overlay" class="menu-overlay" onclick="closeAllMenus()"></div>
        
        <div id="side-menu" class="side-menu">
            <div class="menu-header">
                <h2 style="font-family: 'Barabara'; letter-spacing: 1px; margin: 0;">SILAY EXPLORER</h2>
                <i class="fas fa-times" onclick="toggleMenu()" style="cursor: pointer; font-size: 1.2rem;"></i>
            </div>
            <ul class="menu-list">
                <li onclick="toggleMenu(); showScreen('home-screen')"><i class="fas fa-home"></i> Home</li>
                <li onclick="toggleMenu(); showScreen('map-screen')"><i class="fas fa-map-marked-alt"></i> Map Guide</li>
                <li onclick="toggleMenu(); showScreen('events-screen')"><i class="fas fa-calendar-alt"></i> Events</li>
                <li onclick="toggleMenu(); openQRScanner()"><i class="fas fa-qrcode"></i> QR Scanner</li>
                <li onclick="toggleMenu(); checkItinerary()"><i class="fas fa-clipboard-list"></i> My Itinerary</li>
                <li onclick="toggleMenu(); showScreen('about-screen')"><i class="fas fa-info-circle"></i> About App</li>
            </ul>
            <div style="margin-top: auto; padding: 20px; text-align: center; color: #aaa; font-size: 0.8rem;">
                <p>Version 1.0 Prototype</p>
            </div>
        </div>

        <div id="notif-drawer" class="notif-drawer">
            <div class="menu-header">
                <h3 style="margin: 0;">Notifications</h3>
                <i class="fas fa-times" onclick="toggleNotifications()" style="cursor: pointer; font-size: 1.2rem;"></i>
            </div>
            <div style="flex: 1; overflow-y: auto;">
                <div class="notif-item unread" onclick="toggleNotifications(); showScreen('events-screen');">
                    <div class="notif-icon-box"><i class="fas fa-calendar-check"></i></div>
                    <div class="notif-text">
                        <h4>Upcoming Event: Kansilay</h4>
                        <p>The annual festival starts in 2 days at the Public Plaza. Don't miss the parade!</p>
                        <span class="notif-time">2 mins ago</span>
                    </div>
                </div>
                </div>
        </div>

        <div id="landing-screen" class="screen active">
            <div class="landing-content">
                <h1>SILAY EXPLORER</h1>
                <p>Discover, Experience, and Explore the Paris of Negros!</p>
                <button class="btn-primary" onclick="showScreen('home-screen')">Explore Now!</button>
            </div>
        </div>

        <div id="home-screen" class="screen">
            <div class="home-header">
                <div class="top-nav">
                    <i class="fas fa-bars" onclick="toggleMenu()"></i>
                    
                    <div class="bell-wrapper" onclick="toggleNotifications()">
                        <i class="fas fa-bell"></i>
                        <div id="red-dot" class="red-dot"></div>
                    </div>
                </div>
                <div>
                    <h2 style="font-size: 1.5rem; font-weight: 700;">Welcome to Silay</h2>
                    <p style="opacity: 0.9; font-size: 0.85rem;">The Paris of Negros - Where Heritage Meets Adventure   </p>
                    <div class="search-bar">
                        <i class="fas fa-search" style="margin-right: 10px; color: #aaa;"></i> Search your trip
                    </div>
                </div>
            </div>

            <div class="menu-grid">
                <div class="menu-btn" onclick="showScreen('map-screen')">
                    <i class="fas fa-map-marked-alt"></i>
                    <div>
                        <h4>Silay Map</h4>
                        <p>GPS navigation</p>
                    </div>
                </div>
                <div class="menu-btn" onclick="showScreen('events-screen')">
                    <i class="fas fa-calendar-alt"></i>
                    <div>
                        <h4>Events</h4>
                        <p>Find locations</p>
                    </div>
                </div>
                <div class="menu-btn" onclick="openQRScanner()"> 
                    <i class="fas fa-qrcode"></i>
                    <div>
                        <h4>QR Scanner</h4>
                        <p>Instant info</p>
                    </div>
                </div>
                <div class="menu-btn" onclick="showScreen('itinerary-setup-screen')">
                    <i class="fas fa-clipboard-list"></i>
                    <div>
                        <h4>Plan Trip</h4>
                        <p>Create itinerary</p>
                    </div>
                </div>
            </div>

            <h3 class="section-title">Discover Silay</h3>
            <div class="card-scroll">
                
                <div class="card" onclick="openDetail('balay')"> 
                    <img src="heritage head.jpg" alt="Heritage">
                    <div class="card-text">
                        <h4>Heritage Sites</h4>
                        <p style="font-size: 0.75rem; opacity: 0.9;">Ancestral houses...</p>
                    </div>
                </div>

                <div class="card" onclick="openDetail('larga')">
                    <img src="https://images.unsplash.com/photo-1554118811-1e0d58224f24?q=80&w=600" alt="Cafe">
                    <div class="card-text">
                        <h4>CafÃ©s</h4>
                        <p style="font-size: 0.75rem; opacity: 0.9;">Classic brews...</p>
                    </div>
                </div>

                <div class="card" onclick="openDetail('ilaya')">
                    <img src="https://images.unsplash.com/photo-1476514525535-07fb3b4ae5f1?q=80&w=600" alt="Nature">
                    <div class="card-text">
                        <h4>Nature</h4>
                        <p style="font-size: 0.75rem; opacity: 0.9;">Highlands & views</p>
                    </div>
                </div>

            </div>

            <div class="chat-fab" onclick="toggleChat()">
                <i class="fas fa-robot"></i>
            </div>
        </div>

        <div id="itinerary-setup-screen" class="screen">
            <div class="back-btn" onclick="showScreen('home-screen')">
                <i class="fas fa-arrow-left"></i>
            </div>
            
            <div class="page-header" style="background: white; border: none; padding-bottom: 0; padding-top: 100px;">
                <div class="header-title">
                    <h2 style="font-size: 1.8rem; color: var(--primary-green);">Personalize<br>Your Trip</h2>
                    <p>Let us help you plan your Silay experience.</p>
                </div>
            </div>

            <div class="setup-container">
                <div class="pref-section">
                    <h3 class="pref-title">1. What are your interests?</h3>
                    <div class="chip-grid">
                        <div class="chip" onclick="togglePref(this, 'history')">Historical Sites</div>
                        <div class="chip" onclick="togglePref(this, 'nature')">Nature & Views</div>
                        <div class="chip" onclick="togglePref(this, 'food')">Food & Cafe</div>
                        <div class="chip" onclick="togglePref(this, 'adventure')">Adventure</div>
                    </div>
                </div>

                <div class="pref-section">
                    <h3 class="pref-title">2. Duration of visit?</h3>
                    <div class="chip-grid">
                        <div class="chip duration-chip" onclick="selectDuration(this, 'half')">Half Day (4 hrs)</div>
                        <div class="chip duration-chip" onclick="selectDuration(this, 'full')">Full Day (8 hrs)</div>
                    </div>
                </div>

                <div style="margin-top: 50px;">
                    <button class="btn-primary" style="width: 100%;" onclick="generateItinerary()">Generate Itinerary</button>
                </div>
            </div>
        </div>

        <div id="itinerary-screen" class="screen">
            <div class="back-btn" onclick="showScreen('home-screen')">
                <i class="fas fa-arrow-left"></i>
            </div>
            
            <div class="page-header">
                <div style="background: #2F5245; color: white; padding: 12px; border-radius: 50%; width: 50px; height: 50px; display: flex; justify-content: center; align-items: center; margin-right: 15px;">
                    <i class="fas fa-suitcase"></i>
                </div>
                <div class="header-title" style="flex: 1;">
                    <h2>Your Trip</h2>
                    <p id="itinerary-subtitle">Calculated for you</p>
                </div>
                <i class="fas fa-redo-alt" onclick="showScreen('itinerary-setup-screen')" style="color: #2F5245; font-size: 1.2rem; cursor: pointer;"></i>
            </div>

            <div class="itinerary-card">
                <div class="itinerary-header">
                    <span>SUGGESTED ROUTE</span>
                    <span id="itinerary-date">Today</span>
                </div>
                <ul class="dynamic-list" id="generated-list">
                    <li style="text-align: center; color: #999; padding: 20px;">
                        No itinerary yet. <br> Go to 'Plan Trip' to create one!
                    </li>
                </ul>
            </div>
            
            <div style="padding: 0 20px;">
                <button class="btn-primary" style="width: 100%; font-size: 0.9rem;" onclick="showScreen('home-screen')">Save & Return Home</button>
            </div>
        </div>

        <div id="map-screen" class="screen">
            <div class="real-map-container">
                <iframe 
                    src="https://maps.google.com/maps?q=1898+Casa+and+Restaurante+Silay&t=h&z=17&ie=UTF8&iwloc=&output=embed" 
                    allowfullscreen="" 
                    loading="lazy" 
                    referrerpolicy="no-referrer-when-downgrade">
                </iframe>
            </div>

            <div class="back-btn" onclick="showScreen('home-screen')">
                <i class="fas fa-arrow-left"></i>
            </div>
            
            <div class="bottom-sheet">
                <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                    <div>
                        <h3 style="font-size: 1.2rem;">1898 Casa and Restaurante</h3>
                        <p style="font-size: 0.85rem; opacity: 0.7; margin-top: 5px;">Bed and Breakfast â€¢ Heritage</p>
                    </div>
                    <i class="fas fa-times" onclick="showScreen('home-screen')" style="cursor: pointer; opacity: 0.7;"></i>
                </div>
                
                <div class="sheet-actions">
                    <button class="action-btn green-highlight">
                        <i class="fas fa-walking"></i>
                        <span>5 min</span>
                    </button>
                    <button class="action-btn">
                        <i class="fas fa-phone-alt"></i>
                        <span>Call</span>
                    </button>
                    <button class="action-btn">
                        <i class="fas fa-globe"></i>
                        <span>Website</span>
                    </button>
                    <button class="action-btn">
                        <i class="fas fa-calendar-check"></i>
                        <span>Book</span>
                    </button>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 25px;">
                    <img src="https://images.unsplash.com/photo-1597040663436-1e0f0c057116?q=80&w=200" style="width: 50%; height: 80px; object-fit: cover; border-radius: 12px;">
                    <img src="https://images.unsplash.com/photo-1590490360182-c33d57733427?q=80&w=200" style="width: 50%; height: 80px; object-fit: cover; border-radius: 12px;">
                </div>
            </div>
        </div>

        <div id="detail-screen" class="screen">
            <div class="back-btn" onclick="showScreen('home-screen')" style="top: 40px; left: 20px;">
                <i class="fas fa-arrow-left"></i>
            </div>
            <img id="detail-img" src="" class="detail-img">
            
            <div class="detail-content">
                <h2 id="detail-title" style="color: var(--primary-green); font-size: 1.5rem;"></h2>
                <p id="detail-loc" style="color: var(--gray); font-size: 0.9rem; margin-top: 5px;"><i class="fas fa-map-marker-alt"></i></p>
                
                <div class="detail-tabs">
                    <span class="tab active">Overview</span>
                    <span class="tab">Photos</span>
                    <span class="tab">Details</span>
                    <span class="tab">Reviews</span>
                </div>

                <p id="detail-desc" style="font-size: 0.95rem; color: #555; line-height: 1.6;"></p>

                <div style="display: flex; gap: 15px; margin-top: 30px;">
                    <button class="btn-primary" onclick="showScreen('map-screen')" style="flex: 2; padding: 15px; box-shadow: none;">Explore</button>
                    <button class="btn-primary" style="flex: 1; background: white; color: var(--primary-green); border: 2px solid var(--primary-green); padding: 15px; box-shadow: none;"><i class="fas fa-bookmark"></i></button>
                </div>
            </div>
        </div>
        
        <div id="events-screen" class="screen">
            <div class="calendar-header">
                <div class="back-btn" onclick="showScreen('home-screen')" style="position: static; box-shadow: none; border: 1px solid #eee; margin: 0;">
                    <i class="fas fa-arrow-left"></i>
                </div>
                <h2>2025</h2>
                <i class="fas fa-search" style="font-size: 1.2rem;"></i>
            </div>
            
            <h1 style="padding: 0 25px; margin-bottom: 10px;">June</h1>
            <div class="calendar-grid">
                <div class="cal-row">
                    <div class="cal-day">S</div><div class="cal-day">M</div><div class="cal-day">T</div><div class="cal-day">W</div><div class="cal-day">T</div><div class="cal-day">F</div><div class="cal-day">S</div>
                </div>
                <div class="cal-row">
                    <div class="cal-date">8</div><div class="cal-date">9</div><div class="cal-date">10</div><div class="cal-date">11</div><div class="cal-date selected">12</div><div class="cal-date">13</div><div class="cal-date">14</div>
                </div>
                <div class="cal-row">
                    <div class="cal-date">15</div><div class="cal-date">16</div><div class="cal-date">17</div><div class="cal-date">18</div><div class="cal-date">19</div><div class="cal-date">20</div><div class="cal-date">21</div>
                </div>
            </div>
            
            <h3 style="padding: 0 25px; margin-bottom: 15px; color: var(--primary-green);">Upcoming</h3>

            <div class="event-card">
                <img src="https://images.unsplash.com/photo-1533227297464-946a36230e71?q=80&w=1000" style="width: 100%; height: 160px; object-fit: cover;">
                <div style="padding: 20px;">
                    <h3 style="margin-bottom: 5px;">Kansilay Festival</h3>
                    <p style="color: #666; font-size: 0.85rem;"><i class="far fa-clock"></i> 8:00 am - 10:00 pm</p>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px;">
                        <span style="font-size: 0.85rem; color: #888;"><i class="fas fa-map-marker-alt"></i> Silay Public Plaza</span>
                        <button style="background: var(--primary-green); color: white; border: none; padding: 10px 20px; border-radius: 20px; font-size: 0.8rem; cursor: pointer;">View</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="qr-screen" class="screen" style="background: black;">
            <video id="qr-video" playsinline style="width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0;"></video>
            
            <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 5;">
                <div style="width: 250px; height: 250px; border: 2px solid rgba(255,255,255,0.3); border-radius: 20px; position: relative; box-shadow: 0 0 0 1000px rgba(0,0,0,0.5);">
                    <div style="position: absolute; top: -2px; left: -2px; width: 40px; height: 40px; border-left: 4px solid #4CAF50; border-top: 4px solid #4CAF50; border-top-left-radius: 20px;"></div>
                    <div style="position: absolute; top: -2px; right: -2px; width: 40px; height: 40px; border-right: 4px solid #4CAF50; border-top: 4px solid #4CAF50; border-top-right-radius: 20px;"></div>
                    <div style="position: absolute; bottom: -2px; left: -2px; width: 40px; height: 40px; border-left: 4px solid #4CAF50; border-bottom: 4px solid #4CAF50; border-bottom-left-radius: 20px;"></div>
                    <div style="position: absolute; bottom: -2px; right: -2px; width: 40px; height: 40px; border-right: 4px solid #4CAF50; border-bottom: 4px solid #4CAF50; border-bottom-right-radius: 20px;"></div>
                    <div class="scan-line" style="width: 100%; height: 2px; background: #4CAF50; box-shadow: 0 0 4px #4CAF50; position: absolute; animation: scanAnim 2s infinite;"></div>
                </div>
                <p style="color: white; margin-top: 20px; font-size: 0.9rem; z-index: 10;">Align QR code within frame</p>
                <button onclick="closeQRScanner()" style="margin-top: 40px; background: rgba(255,255,255,0.2); border: none; padding: 10px 20px; border-radius: 30px; color: white; cursor: pointer; z-index: 10;">
                    Cancel
                </button>
            </div>
        </div>

        <div id="about-screen" class="screen">
            <div class="back-btn" onclick="showScreen('home-screen')" style="top: 20px; left: 20px; box-shadow: none; border: 1px solid #ddd;">
                <i class="fas fa-arrow-left"></i>
            </div>
            
            <div class="about-logo">
                <i class="fas fa-city"></i>
            </div>
            
            <div class="about-content">
                <h1 style="font-family: 'Barabara'; margin-bottom: 5px; color: var(--primary-green);">SILAY EXPLORER</h1>
                <span class="version-tag">Version 1.1.0</span>
                
                <p style="color: #666; line-height: 1.6; margin-bottom: 20px;">
                    Silay Explorer is your ultimate digital guide to the "Paris of Negros." Discover heritage houses, find local cafes, and explore the rich culture of Silay City with our interactive map and events guide.
                </p>
                
                <div class="developer-section">
                    <h4 style="color: var(--text-dark); margin-bottom: 10px;">Developed By</h4>
                    <p style="color: var(--primary-green); font-weight: 600;">College of Computer Studies</p>
                    <p style="font-size: 0.8rem; color: #888; margin-top: 5px;">Programmer</p>
                    <p style="font-size: 0.8rem; color: #000; margin-top: 5px;">JOHN NIEL FERRER</p>
                    <p style="font-size: 0.8rem; color: #888; margin-top: 5px;">Documents</p>
                    <p style="font-size: 0.8rem; color: #000; margin-top: 5px;">BERNIEL ABAYON</p>
                    <p style="font-size: 0.8rem; color: #000; margin-top: 5px;">FRANCIS SAPICO</p>
                    <p style="font-size: 0.8rem; color: #000; margin-top: 5px;">KARL DANEIL DEQUILLA</p>
                </div>
                
                <div style="margin-top: 40px;">
                    <button class="btn-primary" onclick="window.location.href='mailto:support@silayexplorer.com'">Contact Support</button>
                </div>
            </div>
        </div>

        <div id="chat-screen" class="chat-screen-overlay">
            <div class="chat-header">
                <i class="fas fa-arrow-left" onclick="toggleChat()" style="cursor: pointer;"></i>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 35px; height: 35px; background: white; border-radius: 50%; display: flex; justify-content: center; align-items: center; color: var(--primary-green);">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div>
                        <h3 style="font-size: 1rem; margin: 0;">Larga Ta Silay AI</h3>
                        <p style="font-size: 0.7rem; margin: 0; opacity: 0.8;">Always active</p>
                    </div>
                </div>
            </div>

            <div class="chat-messages" id="chat-messages">
                <div class="message bot">
                    Hello! I'm your Silay Explorer guide. Ask me about heritage houses, food, or events! ðŸŒ´
                </div>
            </div>
            
            <p id="typing-indicator" class="typing-indicator">Silay AI is typing...</p>

            <div class="chat-input-area">
                <input type="text" id="chat-input" class="chat-input" placeholder="Ask about Silay..." onkeypress="handleEnter(event)">
                <button class="send-btn" onclick="sendMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>

    </div>

<script>
        // --- DATA FOR PLACES ---
        const placesData = {
            balay: {
                title: "Balay Negrense",
                loc: "Cinco de Noviembre St.",
                desc: "The first museum in Negros Occidental, showcasing the lifestyle of a 19th-century sugar baron. A must-visit heritage house!",
                img: "Negrense.jpg"
            },
            larga: {
                title: "Larga Cafe",
                loc: "J Pitong, Calle Ledesma St.",
                desc: "A rustic cafe offering the best local coffee and delicacies amidst the scenic views of Silay's countryside.",
                img: "Larga.jpg"
            },
            ilaya: {
                title: "Ilaya Highland Resort",
                loc: "Patag, Silay City",
                desc: "Ilaya Highland Resort offers breathtaking mountain views, cool breezes, and relaxing pools nestled in the highlands of Patag.",
                img: "Illaya.jpg"
            }
        };

        // --- NEW: ATTRACTION DATABASE FOR ITINERARY ---
        const attractionDb = [
            { id: 1, name: "Balay Negrense", category: "history", time: "09:00 AM" },
            { id: 2, name: "San Diego Cathedral", category: "history", time: "10:30 AM" },
            { id: 3, name: "El Ideal Bakery", category: "food", time: "11:30 AM" },
            { id: 4, name: "Balay Puti", category: "food", time: "12:30 PM" },
            { id: 5, name: "Bernardino Jalandoni", category: "history", time: "02:00 PM" },
            { id: 6, name: "Silay Public Plaza", category: "nature", time: "03:30 PM" },
            { id: 7, name: "Patag Eco Park", category: "nature", time: "08:00 AM" },
            { id: 8, name: "Lantawan View", category: "nature", time: "10:00 AM" },
            { id: 9, name: "Larga Cafe", category: "adventure", time: "02:00 PM" },
            { id: 10, name: "Punong Gary's", category: "food", time: "06:00 PM" },
            { id: 11, name: "Mangrove Eco-Park", category: "adventure", time: "04:00 PM" }
        ];

        // User Preferences State
        let selectedCategories = [];
        let selectedDuration = null;
        let generatedItinerary = [];

        // --- NAVIGATION FUNCTION ---
        function showScreen(screenId) {
            const screens = document.querySelectorAll('.screen');
            screens.forEach(screen => {
                screen.classList.remove('active');
                screen.style.display = 'none'; 
            });

            const activeScreen = document.getElementById(screenId);
            if (activeScreen) {
                activeScreen.style.display = 'block';
                setTimeout(() => {
                    activeScreen.classList.add('active');
                }, 10);
            }
        }

        // --- CHECK ITINERARY LOGIC ---
        function checkItinerary() {
            // If empty, go to setup. If full, go to result.
            if (generatedItinerary.length === 0) {
                showScreen('itinerary-setup-screen');
            } else {
                showScreen('itinerary-screen');
            }
        }

        // --- OPEN DETAIL PAGE DYNAMICALLY ---
        function openDetail(placeKey) {
            const data = placesData[placeKey];
            if (data) {
                document.getElementById('detail-title').innerText = data.title;
                document.getElementById('detail-loc').innerHTML = `<i class="fas fa-map-marker-alt"></i> ${data.loc}`;
                document.getElementById('detail-desc').innerText = data.desc;
                document.getElementById('detail-img').src = data.img;
                showScreen('detail-screen');
            }
        }

        // --- ITINERARY GENERATOR LOGIC ---
        
        function togglePref(element, category) {
            element.classList.toggle('selected');
            if (selectedCategories.includes(category)) {
                selectedCategories = selectedCategories.filter(c => c !== category);
            } else {
                selectedCategories.push(category);
            }
        }

        function selectDuration(element, duration) {
            // Remove active class from all duration chips
            document.querySelectorAll('.duration-chip').forEach(chip => chip.classList.remove('selected'));
            // Add to clicked one
            element.classList.add('selected');
            selectedDuration = duration;
        }

        function generateItinerary() {
            if (selectedCategories.length === 0 || !selectedDuration) {
                alert("Please select at least one interest and a duration.");
                return;
            }

            // 1. Filter attractions based on selected categories
            let filtered = attractionDb.filter(place => selectedCategories.includes(place.category));
            
            // 2. Logic to limit items based on duration
            // Half day = max 3 items, Full day = max 6 items
            const limit = selectedDuration === 'half' ? 3 : 6;
            
            // Randomize slightly for variety (mocking real logic)
            filtered.sort(() => 0.5 - Math.random());
            
            // Slice to limit
            generatedItinerary = filtered.slice(0, limit);

            // 3. Render
            renderItinerary();
            showScreen('itinerary-screen');
        }

        function renderItinerary() {
            const listContainer = document.getElementById('generated-list');
            listContainer.innerHTML = ""; // Clear existing

            if (generatedItinerary.length === 0) {
                listContainer.innerHTML = '<li style="text-align: center; color: #999; padding: 20px;">No matching places found. Try selecting more interests!</li>';
                return;
            }

            // Update header
            document.getElementById('itinerary-subtitle').innerText = 
                selectedDuration === 'half' ? "Half Day Tour" : "Full Day Adventure";

            generatedItinerary.forEach((place, index) => {
                const li = document.createElement('li');
                li.className = 'dynamic-item';
                
                // Add index to handle checkbox toggles specifically
                li.innerHTML = `
                    <input type="checkbox" class="item-checkbox" checked onchange="toggleItemStatus(this)">
                    <div class="item-info">
                        <span class="item-time">${place.time}</span>
                        <h4>${place.name}</h4>
                        <p>${place.category.charAt(0).toUpperCase() + place.category.slice(1)}</p>
                    </div>
                `;
                listContainer.appendChild(li);
            });
        }

        function toggleItemStatus(checkbox) {
            const itemRow = checkbox.parentElement;
            if (checkbox.checked) {
                itemRow.classList.remove('disabled');
            } else {
                itemRow.classList.add('disabled');
            }
        }

        // --- MENU TOGGLES (UPDATED) ---
        function closeAllMenus() {
            document.getElementById('side-menu').classList.remove('active');
            document.getElementById('notif-drawer').classList.remove('active');
            document.getElementById('menu-overlay').classList.remove('active');
        }

        function toggleMenu() {
            const menu = document.getElementById('side-menu');
            const overlay = document.getElementById('menu-overlay');
            const notif = document.getElementById('notif-drawer');
            
            if (notif.classList.contains('active')) {
                notif.classList.remove('active');
            }

            if (menu.classList.contains('active')) {
                menu.classList.remove('active');
                overlay.classList.remove('active');
            } else {
                menu.classList.add('active');
                overlay.classList.add('active');
            }
        }

        function toggleNotifications() {
            const notif = document.getElementById('notif-drawer');
            const menu = document.getElementById('side-menu');
            const overlay = document.getElementById('menu-overlay');
            const redDot = document.getElementById('red-dot');

            if (menu.classList.contains('active')) {
                menu.classList.remove('active');
            }

            if (notif.classList.contains('active')) {
                notif.classList.remove('active');
                overlay.classList.remove('active');
            } else {
                notif.classList.add('active');
                overlay.classList.add('active');
                redDot.classList.remove('visible');
            }
        }

        window.onload = function() {
            setTimeout(() => {
                const redDot = document.getElementById('red-dot');
                if (redDot) redDot.classList.add('visible');
            }, 3000); 
        };

        // --- SMART QR SCANNER ---
        let videoStream = null;

        async function openQRScanner() {
            showScreen('qr-screen');
            const video = document.getElementById('qr-video');

            if (!video) {
                alert("Error: HTML for camera missing.");
                return;
            }

            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: "environment" } 
                });
                videoStream = stream;
                video.srcObject = stream;
                video.play();
            } catch (err) {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ 
                        video: true 
                    });
                    videoStream = stream;
                    video.srcObject = stream;
                    video.play();
                } catch (fallbackErr) {
                    alert("Camera failed. Please allow camera permissions.");
                    showScreen('home-screen');
                }
            }
        }

        function closeQRScanner() {
            const video = document.getElementById('qr-video');
            if (videoStream) {
                videoStream.getTracks().forEach(track => track.stop());
                videoStream = null;
            }
            if (video) video.srcObject = null;
            showScreen('home-screen');
        }

        // --- AI CHATBOT LOGIC ---
        function toggleChat() {
            const chatScreen = document.getElementById('chat-screen');
            if (chatScreen.style.display === 'flex') {
                chatScreen.style.display = 'none';
            } else {
                chatScreen.style.display = 'flex';
            }
        }

        function handleEnter(e) {
            if (e.key === 'Enter') sendMessage();
        }

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            if (message === "") return;

            addMessage(message, 'user');
            input.value = "";

            const typing = document.getElementById('typing-indicator');
            typing.style.display = 'block';

            setTimeout(() => {
                typing.style.display = 'none';
                const botResponse = getBotResponse(message);
                addMessage(botResponse, 'bot');
            }, 1500);
        }

        function addMessage(text, sender) {
            const messagesContainer = document.getElementById('chat-messages');
            const msgDiv = document.createElement('div');
            msgDiv.classList.add('message', sender);
            msgDiv.innerText = text;
            messagesContainer.appendChild(msgDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function getBotResponse(input) {
            input = input.toLowerCase();
            if (input.includes('hello') || input.includes('hi')) return "Maayong aga! Welcome to Silay. How can I help you explore today?";
            if (input.includes('food') || input.includes('eat')) return "You must try El Ideal Bakery for their Guapple Pie! Or try the heritage dining at 1898 Casa.";
            if (input.includes('map')) return "You can check our Interactive Map in the menu to see all heritage sites nearby!";
            return "That's interesting! I'm just a prototype AI, but I suggest checking the 'Plan Trip' section for more info about Silay.";
        }
    </script>
</body>
</html>
